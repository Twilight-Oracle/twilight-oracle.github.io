!function(){"use strict";function e(t){if(!(this instanceof e))return new e(t);this._=t}var t=e.prototype;function n(e,t){for(var n=0;n<e;n++)t(n)}function r(e,t,r){return function(e,t){n(t.length,(function(n){e(t[n],n,t)}))}((function(n,r,o){t=e(t,n,r,o)}),r),t}function o(e,t){return r((function(t,n,r,o){return t.concat([e(n,r,o)])}),[],t)}function i(e){var t=r((function(e,t,n,r){return e.concat(n===r.length-1?Buffer.from([t,0]).readUInt16BE(0):r.readUInt16BE(n))}),[],e);return Buffer.from(o((function(e){return(e<<1&65535)>>8}),t))}function a(e){return e[0]>>7}function u(){return"undefined"!=typeof Buffer}function s(){if(!u())throw new Error("Buffer global does not exist; please use webpack if you need to parse Buffers in the browser.")}function c(t){s();var o=r((function(e,t){return e+t}),0,t);if(o%8!=0)throw new Error("The bits ["+t.join(", ")+"] add up to "+o+" which is not an even number of bytes; the total should be divisible by 8");var u,c=o/8,l=(u=function(e){return e>48},r((function(e,t){return e||(u(t)?t:e)}),null,t));if(l)throw new Error(l+" bit range requested exceeds 48 bit (6 byte) Number max.");return new e((function(e,o){var u=c+o;return u>e.length?w(o,c.toString()+" bytes"):b(u,r((function(e,t){var r=function(e,t){var r={v:0,buf:t};return n(e,(function(){r={v:r.v<<1|a(r.buf),buf:i(r.buf)}})),r}(t,e.buf);return{coll:e.coll.concat(r.v),buf:r.buf}}),{coll:[],buf:e.slice(o,u)},t).coll)}))}function l(t,n){return new e((function(e,r){return s(),r+n>e.length?w(r,n+" bytes for "+t):b(r+n,e.slice(r,r+n))}))}function f(e,t){if("number"!=typeof(n=t)||Math.floor(n)!==n||t<0||t>6)throw new Error(e+" requires integer length in range [0, 6].");var n}function p(e){return f("uintBE",e),l("uintBE("+e+")",e).map((function(t){return t.readUIntBE(0,e)}))}function d(e){return f("uintLE",e),l("uintLE("+e+")",e).map((function(t){return t.readUIntLE(0,e)}))}function h(e){return f("intBE",e),l("intBE("+e+")",e).map((function(t){return t.readIntBE(0,e)}))}function v(e){return f("intLE",e),l("intLE("+e+")",e).map((function(t){return t.readIntLE(0,e)}))}function _(e){return Array.prototype.slice.call(e)}function g(t){return t instanceof e}function m(e){return"[object Array]"==={}.toString.call(e)}function y(e){return u()&&Buffer.isBuffer(e)}function b(e,t){return{status:!0,index:e,value:t,furthest:-1,expected:[]}}function w(e,t){return m(t)||(t=[t]),{status:!1,index:-1,value:null,furthest:e,expected:t}}function E(t,n){if(!n)return t;if(t.furthest>n.furthest)return t;var r=t.furthest===n.furthest?function(t,n){if(function(){if(void 0!==e._supportsSet)return e._supportsSet;var t="undefined"!=typeof Set;return e._supportsSet=t,t}()&&Array.from){for(var r=new Set(t),o=0;o<n.length;o++)r.add(n[o]);var i=Array.from(r);return i.sort(),i}for(var a={},u=0;u<t.length;u++)a[t[u]]=!0;for(var s=0;s<n.length;s++)a[n[s]]=!0;var c=[];for(var l in a)({}).hasOwnProperty.call(a,l)&&c.push(l);return c.sort(),c}(t.expected,n.expected):n.expected;return{status:t.status,index:t.index,value:t.value,furthest:n.furthest,expected:r}}var x={};function k(e,t){if(y(e))return{offset:t,line:-1,column:-1};if(x.input===e&&x.i===t)return x.value;var n=e.slice(0,t).split("\n"),r={offset:t,line:n.length,column:n[n.length-1].length+1};return x.input=e,x.i=t,x.value=r,r}function S(e){if(!g(e))throw new Error("not a parser: "+e)}function O(e,t){return"string"==typeof e?e.charAt(t):e[t]}function j(e){if("number"!=typeof e)throw new Error("not a number: "+e)}function N(e){if(!(e instanceof RegExp))throw new Error("not a regexp: "+e);for(var t=D(e),n=0;n<t.length;n++){var r=t.charAt(n);if("i"!==r&&"m"!==r&&"u"!==r)throw new Error('unsupported regexp flag "'+r+'": '+e)}}function P(e){if("function"!=typeof e)throw new Error("not a function: "+e)}function B(e){if("string"!=typeof e)throw new Error("not a string: "+e)}function $(e,t){return new Array(t+1).join(e)}function q(e,t,n){var r=t-e.length;return r<=0?e:$(n,r)+e}function A(e,t,n,r){return{from:e-t>0?e-t:0,to:e+n>r?r:e+n}}function L(e,t){var n,i,a,u,s,c=t.index,l=c.offset,f=1;if(l===e.length)return"Got the end of the input";if(y(e)){var p=l-l%8,d=l-p,h=A(p,40,40,e.length),v=o((function(e){return o((function(e){return q(e.toString(16),2,"0")}),e)}),function(e,t){var n=e.length,r=[],o=0;if(n<=t)return[e.slice()];for(var i=0;i<n;i++)r[o]||r.push([]),r[o].push(e[i]),(i+1)%t==0&&o++;return r}(e.slice(h.from,h.to).toJSON().data,8));u=function(e){return 0===e.from&&1===e.to?{from:e.from,to:e.to}:{from:e.from/8,to:Math.floor(e.to/8)}}(h),i=p/8,n=3*d,d>=4&&(n+=1),f=2,a=o((function(e){return e.length<=4?e.join(" "):e.slice(0,4).join(" ")+"  "+e.slice(4).join(" ")}),v),(s=(8*(u.to>0?u.to-1:u.to)).toString(16).length)<2&&(s=2)}else{var _=e.split(/\r\n|[\n\r\u2028\u2029]/);n=c.column-1,i=c.line-1,u=A(i,2,3,_.length),a=_.slice(u.from,u.to),s=u.to.toString().length}var g=i-u.from;return y(e)&&(s=(8*(u.to>0?u.to-1:u.to)).toString(16).length)<2&&(s=2),r((function(t,r,o){var i,a=o===g,c=a?"> ":"  ";return i=y(e)?q((8*(u.from+o)).toString(16),s,"0"):q((u.from+o+1).toString(),s," "),[].concat(t,[c+i+" | "+r],a?["  "+$(" ",s)+" | "+q("",n," ")+$("^",f)]:[])}),[],a).join("\n")}function M(e,t){return["\n","-- PARSING FAILED "+$("-",50),"\n\n",L(e,t),"\n\n",(n=t.expected,1===n.length?"Expected:\n\n"+n[0]:"Expected one of the following: \n\n"+n.join(", ")),"\n"].join("");var n}function D(e){var t=""+e;return t.slice(t.lastIndexOf("/")+1)}function U(e){return RegExp("^(?:"+e.source+")",D(e))}function C(){for(var t=[].slice.call(arguments),n=t.length,r=0;r<n;r+=1)S(t[r]);return e((function(e,r){for(var o,i=new Array(n),a=0;a<n;a+=1){if(!(o=E(t[a]._(e,r),o)).status)return o;i[a]=o.value,r=o.index}return E(b(r,i),o)}))}function W(){var e=[].slice.call(arguments);if(0===e.length)throw new Error("seqMap needs at least one argument");var t=e.pop();return P(t),C.apply(null,e).map((function(e){return t.apply(null,e)}))}function T(){var t=[].slice.call(arguments),n=t.length;if(0===n)return G("zero alternates");for(var r=0;r<n;r+=1)S(t[r]);return e((function(e,n){for(var r,o=0;o<t.length;o+=1)if((r=E(t[o]._(e,n),r)).status)return r;return r}))}function I(e,t){return R(e,t).or(z([]))}function R(e,t){return S(e),S(t),W(e,t.then(e).many(),(function(e,t){return[e].concat(t)}))}function F(t){B(t);var n="'"+t+"'";return e((function(e,r){var o=r+t.length,i=e.slice(r,o);return i===t?b(o,i):w(r,n)}))}function H(t,n){N(t),arguments.length>=2?j(n):n=0;var r=U(t),o=""+t;return e((function(e,t){var i=r.exec(e.slice(t));if(i){if(0<=n&&n<=i.length){var a=i[0],u=i[n];return b(t+a.length,u)}return w(t,"valid match group (0 to "+i.length+") in "+o)}return w(t,o)}))}function z(t){return e((function(e,n){return b(n,t)}))}function G(t){return e((function(e,n){return w(n,t)}))}function V(t){if(g(t))return e((function(e,n){var r=t._(e,n);return r.index=n,r.value="",r}));if("string"==typeof t)return V(F(t));if(t instanceof RegExp)return V(H(t));throw new Error("not a string, regexp, or parser: "+t)}function J(t){return S(t),e((function(e,n){var r=t._(e,n),o=e.slice(n,r.index);return r.status?w(n,'not "'+o+'"'):b(n,null)}))}function K(t){return P(t),e((function(e,n){var r=O(e,n);return n<e.length&&t(r)?b(n+1,r):w(n,"a character/byte matching "+t)}))}function Q(t,n){arguments.length<2&&(n=t,t=void 0);var r=e((function(e,t){return r._=n()._,r._(e,t)}));return t?r.desc(t):r}function X(){return G("fantasy-land/empty")}t.parse=function(e){if("string"!=typeof e&&!y(e))throw new Error(".parse must be called with a string or Buffer as its argument");var t=this.skip(te)._(e,0);return t.status?{status:!0,value:t.value}:{status:!1,index:k(e,t.furthest),expected:t.expected}},t.tryParse=function(e){var t=this.parse(e);if(t.status)return t.value;var n=M(e,t),r=new Error(n);throw r.type="ParsimmonError",r.result=t,r},t.assert=function(e,t){return this.chain((function(n){return e(n)?z(n):G(t)}))},t.or=function(e){return T(this,e)},t.trim=function(e){return this.wrap(e,e)},t.wrap=function(e,t){return W(e,this,t,(function(e,t){return t}))},t.thru=function(e){return e(this)},t.then=function(e){return S(e),C(this,e).map((function(e){return e[1]}))},t.many=function(){var t=this;return e((function(e,n){for(var r=[],o=void 0;;){if(!(o=E(t._(e,n),o)).status)return E(b(n,r),o);if(n===o.index)throw new Error("infinite loop detected in .many() parser --- calling .many() on a parser which can accept zero characters is usually the cause");n=o.index,r.push(o.value)}}))},t.tieWith=function(e){return B(e),this.map((function(t){if(function(e){if(!m(e))throw new Error("not an array: "+e)}(t),t.length){B(t[0]);for(var n=t[0],r=1;r<t.length;r++)B(t[r]),n+=e+t[r];return n}return""}))},t.tie=function(){return this.tieWith("")},t.times=function(t,n){var r=this;return arguments.length<2&&(n=t),j(t),j(n),e((function(e,o){for(var i=[],a=void 0,u=void 0,s=0;s<t;s+=1){if(u=E(a=r._(e,o),u),!a.status)return u;o=a.index,i.push(a.value)}for(;s<n&&(u=E(a=r._(e,o),u),a.status);s+=1)o=a.index,i.push(a.value);return E(b(o,i),u)}))},t.result=function(e){return this.map((function(){return e}))},t.atMost=function(e){return this.times(0,e)},t.atLeast=function(e){return W(this.times(e),this.many(),(function(e,t){return e.concat(t)}))},t.map=function(t){P(t);var n=this;return e((function(e,r){var o=n._(e,r);return o.status?E(b(o.index,t(o.value)),o):o}))},t.contramap=function(t){P(t);var n=this;return e((function(e,r){var o=n.parse(t(e.slice(r)));return o.status?b(r+e.length,o.value):o}))},t.promap=function(e,t){return P(e),P(t),this.contramap(e).map(t)},t.skip=function(e){return C(this,e).map((function(e){return e[0]}))},t.mark=function(){return W(Y,this,Y,(function(e,t,n){return{start:e,value:t,end:n}}))},t.node=function(e){return W(Y,this,Y,(function(t,n,r){return{name:e,value:n,start:t,end:r}}))},t.sepBy=function(e){return I(this,e)},t.sepBy1=function(e){return R(this,e)},t.lookahead=function(e){return this.skip(V(e))},t.notFollowedBy=function(e){return this.skip(J(e))},t.desc=function(t){m(t)||(t=[t]);var n=this;return e((function(e,r){var o=n._(e,r);return o.status||(o.expected=t),o}))},t.fallback=function(e){return this.or(z(e))},t.ap=function(e){return W(e,this,(function(e,t){return e(t)}))},t.chain=function(t){var n=this;return e((function(e,r){var o=n._(e,r);return o.status?E(t(o.value)._(e,o.index),o):o}))},t.concat=t.or,t.empty=X,t.of=z,t["fantasy-land/ap"]=t.ap,t["fantasy-land/chain"]=t.chain,t["fantasy-land/concat"]=t.concat,t["fantasy-land/empty"]=t.empty,t["fantasy-land/of"]=t.of,t["fantasy-land/map"]=t.map;var Y=e((function(e,t){return b(t,k(e,t))})),Z=e((function(e,t){return t>=e.length?w(t,"any character/byte"):b(t+1,O(e,t))})),ee=e((function(e,t){return b(e.length,e.slice(t))})),te=e((function(e,t){return t<e.length?w(t,"EOF"):b(t,null)})),ne=H(/[0-9]/).desc("a digit"),re=H(/[0-9]*/).desc("optional digits"),oe=H(/[a-z]/i).desc("a letter"),ie=H(/[a-z]*/i).desc("optional letters"),ae=H(/\s*/).desc("optional whitespace"),ue=H(/\s+/).desc("whitespace"),se=F("\r"),ce=F("\n"),le=F("\r\n"),fe=T(le,ce,se).desc("newline"),pe=T(fe,te);e.all=ee,e.alt=T,e.any=Z,e.cr=se,e.createLanguage=function(e){var t={};for(var n in e)({}).hasOwnProperty.call(e,n)&&function(n){t[n]=Q((function(){return e[n](t)}))}(n);return t},e.crlf=le,e.custom=function(t){return e(t(b,w))},e.digit=ne,e.digits=re,e.empty=X,e.end=pe,e.eof=te,e.fail=G,e.formatError=M,e.index=Y,e.isParser=g,e.lazy=Q,e.letter=oe,e.letters=ie,e.lf=ce,e.lookahead=V,e.makeFailure=w,e.makeSuccess=b,e.newline=fe,e.noneOf=function(e){return K((function(t){return e.indexOf(t)<0})).desc("none of '"+e+"'")},e.notFollowedBy=J,e.of=z,e.oneOf=function(e){for(var t=e.split(""),n=0;n<t.length;n++)t[n]="'"+t[n]+"'";return K((function(t){return e.indexOf(t)>=0})).desc(t)},e.optWhitespace=ae,e.Parser=e,e.range=function(e,t){return K((function(n){return e<=n&&n<=t})).desc(e+"-"+t)},e.regex=H,e.regexp=H,e.sepBy=I,e.sepBy1=R,e.seq=C,e.seqMap=W,e.seqObj=function(){for(var t={},n=0,r=_(arguments),o=r.length,i=0;i<o;i+=1){var a=r[i];if(!g(a)){if(m(a)){var u=2===a.length&&"string"==typeof a[0]&&g(a[1]);if(u){var s=a[0];if(Object.prototype.hasOwnProperty.call(t,s))throw new Error("seqObj: duplicate key "+s);t[s]=!0,n++;continue}}throw new Error("seqObj arguments must be parsers or [string, parser] array pairs.")}}if(0===n)throw new Error("seqObj expects at least one named parser, found zero");return e((function(e,t){for(var n,i={},a=0;a<o;a+=1){var u,s;if(m(r[a])?(u=r[a][0],s=r[a][1]):(u=null,s=r[a]),!(n=E(s._(e,t),n)).status)return n;u&&(i[u]=n.value),t=n.index}return E(b(t,i),n)}))},e.string=F,e.succeed=z,e.takeWhile=function(t){return P(t),e((function(e,n){for(var r=n;r<e.length&&t(O(e,r));)r++;return b(r,e.slice(n,r))}))},e.test=K,e.whitespace=ue,e["fantasy-land/empty"]=X,e["fantasy-land/of"]=z,e.Binary={bitSeq:c,bitSeqObj:function(e){s();var t={},n=0,i=o((function(e){if(m(e)){var r=e;if(2!==r.length)throw new Error("["+r.join(", ")+"] should be length 2, got length "+r.length);if(B(r[0]),j(r[1]),Object.prototype.hasOwnProperty.call(t,r[0]))throw new Error("duplicate key in bitSeqObj: "+r[0]);return t[r[0]]=!0,n++,r}return j(e),[null,e]}),e);if(n<1)throw new Error("bitSeqObj expects at least one named pair, got ["+e.join(", ")+"]");var a=o((function(e){return e[0]}),i);return c(o((function(e){return e[1]}),i)).map((function(e){return r((function(e,t){return null!==t[0]&&(e[t[0]]=t[1]),e}),{},o((function(t,n){return[t,e[n]]}),a))}))},byte:function(t){if(s(),j(t),t>255)throw new Error("Value specified to byte constructor ("+t+"=0x"+t.toString(16)+") is larger in value than a single byte.");var n=(t>15?"0x":"0x0")+t.toString(16);return e((function(e,r){var o=O(e,r);return o===t?b(r+1,o):w(r,n)}))},buffer:function(e){return l("buffer",e).map((function(e){return Buffer.from(e)}))},encodedString:function(e,t){return l("string",t).map((function(t){return t.toString(e)}))},uintBE:p,uint8BE:p(1),uint16BE:p(2),uint32BE:p(4),uintLE:d,uint8LE:d(1),uint16LE:d(2),uint32LE:d(4),intBE:h,int8BE:h(1),int16BE:h(2),int32BE:h(4),intLE:v,int8LE:v(1),int16LE:v(2),int32LE:v(4),floatBE:l("floatBE",4).map((function(e){return e.readFloatBE(0)})),floatLE:l("floatLE",4).map((function(e){return e.readFloatLE(0)})),doubleBE:l("doubleBE",8).map((function(e){return e.readDoubleBE(0)})),doubleLE:l("doubleLE",8).map((function(e){return e.readDoubleLE(0)}))};var de=e;function he(e){return de.string(e)}class ve{constructor(){var{operators:e=[":",">=","<=","<","=",">"]}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.language=de.createLanguage({operator:()=>de.alt(...e.map(he)),and:e=>e.word.assert(e=>"and"===e,"and"),or:e=>e.word.assert(e=>"or"===e,"or"),not:e=>e.word.assert(e=>"not"===e,"not"),keyword:e=>de.alt(e.and,e.or,e.not),lparen:()=>de.string("("),rparen:()=>de.string(")"),wordTerminator:e=>de.alt(e.lparen,e.rparen,e.quote,e.operator,de.whitespace),word:e=>de.notFollowedBy(e.wordTerminator).then(de.any).atLeast(1).tie(),identifier:e=>e.word.assert(t=>!e.keyword.parse(t).status,"an identifier"),escaped:()=>de.string("\\").then(de.any),phrase:e=>de.alt(e.escaped,de.noneOf('"')).many().tie(),quote:()=>de.string('"'),quoted:e=>e.phrase.wrap(e.quote,e.quote.desc('closing "')),value:e=>de.alt(e.identifier,e.quoted),term:e=>de.alt(de.seq(e.identifier,e.operator,e.value),de.seq(de.of(""),e.operator,e.value),de.seq(de.of(""),de.of(""),e.value),de.seq(de.of(""),e.operator,de.of(""))).node("Term"),nil:()=>de.optWhitespace.result(["","",""]).node("Term"),parenthetical:e=>e.expression.wrap(e.lparen,e.rparen.desc("closing )")).node("Parenthetical"),basic:e=>de.alt(e.term,e.parenthetical),negation:e=>de.alt(e.not.then(de.optWhitespace.then(e.negation).or(e.nil)).node("Not"),e.basic),conjunction:e=>de.alt(de.seq(e.negation.or(e.nil).skip(de.optWhitespace).skip(e.and),de.optWhitespace.then(e.conjunction).or(e.nil)).node("And"),de.seq(e.negation.skip(de.optWhitespace),e.conjunction).node("And"),e.negation),disjunction:e=>de.alt(de.seq(e.conjunction.or(e.nil).skip(de.optWhitespace).skip(e.or),de.optWhitespace.then(e.disjunction).or(e.nil)).node("Or"),e.conjunction),expression:e=>de.alt(e.disjunction.trim(de.optWhitespace),e.nil),query:e=>e.expression})}parse(e){return this.language.query.parse(e)}}function _e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ge(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_e(Object(n),!0).forEach((function(t){me(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_e(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function me(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ye(e){var{left:t,right:n}=e;return"".concat(t," and ").concat(n)}function be(e){var{left:t,right:n}=e;return"".concat(t," or ").concat(n)}function we(e){var{expression:t,negated:n}=e;return"".concat(n?"not ":"","(").concat(t,")")}function Ee(e){var t,{name:n,plural:r,value:o,negated:i}=e;return r&&i?t="do not contain":r&&!i?t="contain":!r&&i?t="does not contain":r||i||(t="contains"),"".concat(n," ").concat(t," ").concat(o)}function xe(e){var t,{name:n,plural:r,value:o,negated:i}=e;return r&&i?t="do not equal":r&&!i?t="equal":!r&&i?t="does not equal":r||i||(t="equals"),"".concat(n," ").concat(t," ").concat(o)}function ke(e){var{name:t,plural:n,value:r,negated:o,relation:i}=e;return"".concat(t," ").concat(n?"are":"is").concat(o?" not":""," ").concat(i," ").concat(r)}function Se(e){return ke(ge(ge({},e),{},{relation:"greater than"}))}function Oe(e){return ke(ge(ge({},e),{},{relation:"at least"}))}function je(e){return ke(ge(ge({},e),{},{relation:"at most"}))}function Ne(e){return ke(ge(ge({},e),{},{relation:"less than"}))}function Pe(e){var{name:t}=e;return'unknown field "'.concat(t,'"')}function Be(e){var{name:t,operator:n}=e;return"can't use \"".concat(n,'" on field "').concat(t,'"')}function $e(e){var{type:t,value:n}=e;return"expected a ".concat(t,', not "').concat(n,'"')}class qe{get(e,t,n){return{status:!0,describe:r=>function(e){var{name:t,operator:n,value:r,negated:o}=e;return"".concat(o?"not ":"").concat(t).concat(n,'"').concat(r,'"')}({name:e,operator:t,value:n,negated:r}),predicate:r=>{var o,i,a,u;switch(""!==e&&(r=null===(o=r)||void 0===o?void 0:o[e]),t){case"":case":":return null!==(i=null===(a=r)||void 0===a||null===(u=a.includes)||void 0===u?void 0:u.call(a,n))&&void 0!==i&&i;case">":return r>n;case">=":return r>=n;case"=":return r==n;case"<=":return r<=n;case"<":return r<n;default:return!1}}}}}class Ae extends Error{constructor(e){super("Invalid AST node ".concat(JSON.stringify(e)))}}function Le(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Me(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class De{constructor(e,t,n){this.name=e,this.plural=t,this.property=n}makeResponse(e,t){var n=/^\s*$/.test(e)?NaN:Number(e);return Number.isNaN(n)?{status:!1,error:$e({type:"number",value:e})}:function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Le(Object(n),!0).forEach((function(t){Me(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Le(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({status:!0},t(n))}makeMessageArg(e){var{value:t,negated:n}=e;return{name:this.name,plural:this.plural,value:t,negated:n}}":"(e){return this.makeResponse(e,e=>({describe:t=>xe(this.makeMessageArg({value:e,negated:t})),predicate:t=>(null==t?void 0:t[this.property])===e}))}">"(e){return this.makeResponse(e,e=>({describe:t=>Se(this.makeMessageArg({value:e,negated:t})),predicate:t=>(null==t?void 0:t[this.property])>e}))}">="(e){return this.makeResponse(e,e=>({describe:t=>Oe(this.makeMessageArg({value:e,negated:t})),predicate:t=>(null==t?void 0:t[this.property])>=e}))}"<="(e){return this.makeResponse(e,e=>({describe:t=>je(this.makeMessageArg({value:e,negated:t})),predicate:t=>(null==t?void 0:t[this.property])<=e}))}"<"(e){return this.makeResponse(e,e=>({describe:t=>Ne(this.makeMessageArg({value:e,negated:t})),predicate:t=>(null==t?void 0:t[this.property])<e}))}}De.prototype["="]=De.prototype[":"];class Ue{constructor(e,t,n){var{caseSensitive:r=!0}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this.name=e,this.plural=t,this.property=n,this.caseSensitive=r}makeMessageArg(e){var{value:t,negated:n}=e;return{name:this.name,plural:this.plural,negated:n,value:'"'.concat(t,'"')}}":"(e){var t=this.caseSensitive?e:e.toUpperCase();return{status:!0,describe:t=>Ee(this.makeMessageArg({value:e,negated:t})),predicate:e=>{var n,r,o,i,a,u=null==e?void 0:e[this.property];return this.caseSensitive||(u=null===(n=u)||void 0===n||null===(r=n.toUpperCase)||void 0===r?void 0:r.call(n)),null!==(o=null===(i=u)||void 0===i||null===(a=i.includes)||void 0===a?void 0:a.call(i,t))&&void 0!==o&&o}}}"="(e){var t=this.caseSensitive?e:e.toUpperCase();return{status:!0,describe:t=>xe(this.makeMessageArg({value:e,negated:t})),predicate:e=>{var n,r,o=null==e?void 0:e[this.property];return this.caseSensitive||(o=null===(n=o)||void 0===n||null===(r=n.toUpperCase)||void 0===r?void 0:r.call(n)),o===t}}}}var Ce,We,Te,Ie,Re,Fe,He={},ze=[],Ge=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function Ve(e,t){for(var n in t)e[n]=t[n];return e}function Je(e){var t=e.parentNode;t&&t.removeChild(e)}function Ke(e,t,n){var r,o=arguments,i={};for(r in t)"key"!==r&&"ref"!==r&&(i[r]=t[r]);if(arguments.length>3)for(n=[n],r=3;r<arguments.length;r++)n.push(o[r]);if(null!=n&&(i.children=n),"function"==typeof e&&null!=e.defaultProps)for(r in e.defaultProps)void 0===i[r]&&(i[r]=e.defaultProps[r]);return Qe(e,i,t&&t.key,t&&t.ref,null)}function Qe(e,t,n,r,o){var i={type:e,props:t,key:n,ref:r,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:o};return null==o&&(i.__v=i),Ce.vnode&&Ce.vnode(i),i}function Xe(e){return e.children}function Ye(e,t){this.props=e,this.context=t}function Ze(e,t){if(null==t)return e.__?Ze(e.__,e.__.__k.indexOf(e)+1):null;for(var n;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e)return n.__e;return"function"==typeof e.type?Ze(e):null}function et(e){var t,n;if(null!=(e=e.__)&&null!=e.__c){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e){e.__e=e.__c.base=n.__e;break}return et(e)}}function tt(e){(!e.__d&&(e.__d=!0)&&We.push(e)&&!Te++||Re!==Ce.debounceRendering)&&((Re=Ce.debounceRendering)||Ie)(nt)}function nt(){for(var e;Te=We.length;)e=We.sort((function(e,t){return e.__v.__b-t.__v.__b})),We=[],e.some((function(e){var t,n,r,o,i,a,u;e.__d&&(a=(i=(t=e).__v).__e,(u=t.__P)&&(n=[],(r=Ve({},i)).__v=r,o=ut(u,i,r,t.__n,void 0!==u.ownerSVGElement,null,n,null==a?Ze(i):a),st(n,i),o!=a&&et(i)))}))}function rt(e,t,n,r,o,i,a,u,s,c){var l,f,p,d,h,v,_,g,m,y=r&&r.__k||ze,b=y.length;for(s==He&&(s=null!=a?a[0]:b?Ze(r,0):null),n.__k=[],l=0;l<t.length;l++)if(null!=(d=n.__k[l]=null==(d=t[l])||"boolean"==typeof d?null:"string"==typeof d||"number"==typeof d?Qe(null,d,null,null,d):Array.isArray(d)?Qe(Xe,{children:d},null,null,null):null!=d.__e||null!=d.__c?Qe(d.type,d.props,d.key,null,d.__v):d)){if(d.__=n,d.__b=n.__b+1,null===(p=y[l])||p&&d.key==p.key&&d.type===p.type)y[l]=void 0;else for(f=0;f<b;f++){if((p=y[f])&&d.key==p.key&&d.type===p.type){y[f]=void 0;break}p=null}if(h=ut(e,d,p=p||He,o,i,a,u,s,c),(f=d.ref)&&p.ref!=f&&(g||(g=[]),p.ref&&g.push(p.ref,null,d),g.push(f,d.__c||h,d)),null!=h){if(null==_&&(_=h),m=void 0,void 0!==d.__d)m=d.__d,d.__d=void 0;else if(a==p||h!=s||null==h.parentNode){e:if(null==s||s.parentNode!==e)e.appendChild(h),m=null;else{for(v=s,f=0;(v=v.nextSibling)&&f<b;f+=2)if(v==h)break e;e.insertBefore(h,s),m=s}"option"==n.type&&(e.value="")}s=void 0!==m?m:h.nextSibling,"function"==typeof n.type&&(n.__d=s)}else s&&p.__e==s&&s.parentNode!=e&&(s=Ze(p))}if(n.__e=_,null!=a&&"function"!=typeof n.type)for(l=a.length;l--;)null!=a[l]&&Je(a[l]);for(l=b;l--;)null!=y[l]&&ft(y[l],y[l]);if(g)for(l=0;l<g.length;l++)lt(g[l],g[++l],g[++l])}function ot(e,t,n){"-"===t[0]?e.setProperty(t,n):e[t]="number"==typeof n&&!1===Ge.test(t)?n+"px":null==n?"":n}function it(e,t,n,r,o){var i,a,u,s,c;if(o?"className"===t&&(t="class"):"class"===t&&(t="className"),"style"===t)if(i=e.style,"string"==typeof n)i.cssText=n;else{if("string"==typeof r&&(i.cssText="",r=null),r)for(s in r)n&&s in n||ot(i,s,"");if(n)for(c in n)r&&n[c]===r[c]||ot(i,c,n[c])}else"o"===t[0]&&"n"===t[1]?(a=t!==(t=t.replace(/Capture$/,"")),u=t.toLowerCase(),t=(u in e?u:t).slice(2),n?(r||e.addEventListener(t,at,a),(e.l||(e.l={}))[t]=n):e.removeEventListener(t,at,a)):"list"!==t&&"tagName"!==t&&"form"!==t&&"type"!==t&&"size"!==t&&!o&&t in e?e[t]=null==n?"":n:"function"!=typeof n&&"dangerouslySetInnerHTML"!==t&&(t!==(t=t.replace(/^xlink:?/,""))?null==n||!1===n?e.removeAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase()):e.setAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase(),n):null==n||!1===n&&!/^ar/.test(t)?e.removeAttribute(t):e.setAttribute(t,n))}function at(e){this.l[e.type](Ce.event?Ce.event(e):e)}function ut(e,t,n,r,o,i,a,u,s){var c,l,f,p,d,h,v,_,g,m,y,b=t.type;if(void 0!==t.constructor)return null;(c=Ce.__b)&&c(t);try{e:if("function"==typeof b){if(_=t.props,g=(c=b.contextType)&&r[c.__c],m=c?g?g.props.value:c.__:r,n.__c?v=(l=t.__c=n.__c).__=l.__E:("prototype"in b&&b.prototype.render?t.__c=l=new b(_,m):(t.__c=l=new Ye(_,m),l.constructor=b,l.render=pt),g&&g.sub(l),l.props=_,l.state||(l.state={}),l.context=m,l.__n=r,f=l.__d=!0,l.__h=[]),null==l.__s&&(l.__s=l.state),null!=b.getDerivedStateFromProps&&(l.__s==l.state&&(l.__s=Ve({},l.__s)),Ve(l.__s,b.getDerivedStateFromProps(_,l.__s))),p=l.props,d=l.state,f)null==b.getDerivedStateFromProps&&null!=l.componentWillMount&&l.componentWillMount(),null!=l.componentDidMount&&l.__h.push(l.componentDidMount);else{if(null==b.getDerivedStateFromProps&&_!==p&&null!=l.componentWillReceiveProps&&l.componentWillReceiveProps(_,m),!l.__e&&null!=l.shouldComponentUpdate&&!1===l.shouldComponentUpdate(_,l.__s,m)||t.__v===n.__v){for(l.props=_,l.state=l.__s,t.__v!==n.__v&&(l.__d=!1),l.__v=t,t.__e=n.__e,t.__k=n.__k,l.__h.length&&a.push(l),c=0;c<t.__k.length;c++)t.__k[c]&&(t.__k[c].__=t);break e}null!=l.componentWillUpdate&&l.componentWillUpdate(_,l.__s,m),null!=l.componentDidUpdate&&l.__h.push((function(){l.componentDidUpdate(p,d,h)}))}l.context=m,l.props=_,l.state=l.__s,(c=Ce.__r)&&c(t),l.__d=!1,l.__v=t,l.__P=e,c=l.render(l.props,l.state,l.context),null!=l.getChildContext&&(r=Ve(Ve({},r),l.getChildContext())),f||null==l.getSnapshotBeforeUpdate||(h=l.getSnapshotBeforeUpdate(p,d)),y=null!=c&&c.type==Xe&&null==c.key?c.props.children:c,rt(e,Array.isArray(y)?y:[y],t,n,r,o,i,a,u,s),l.base=t.__e,l.__h.length&&a.push(l),v&&(l.__E=l.__=null),l.__e=!1}else null==i&&t.__v===n.__v?(t.__k=n.__k,t.__e=n.__e):t.__e=ct(n.__e,t,n,r,o,i,a,s);(c=Ce.diffed)&&c(t)}catch(e){t.__v=null,Ce.__e(e,t,n)}return t.__e}function st(e,t){Ce.__c&&Ce.__c(t,e),e.some((function(t){try{e=t.__h,t.__h=[],e.some((function(e){e.call(t)}))}catch(e){Ce.__e(e,t.__v)}}))}function ct(e,t,n,r,o,i,a,u){var s,c,l,f,p,d=n.props,h=t.props;if(o="svg"===t.type||o,null!=i)for(s=0;s<i.length;s++)if(null!=(c=i[s])&&((null===t.type?3===c.nodeType:c.localName===t.type)||e==c)){e=c,i[s]=null;break}if(null==e){if(null===t.type)return document.createTextNode(h);e=o?document.createElementNS("http://www.w3.org/2000/svg",t.type):document.createElement(t.type,h.is&&{is:h.is}),i=null,u=!1}if(null===t.type)d!==h&&e.data!=h&&(e.data=h);else{if(null!=i&&(i=ze.slice.call(e.childNodes)),l=(d=n.props||He).dangerouslySetInnerHTML,f=h.dangerouslySetInnerHTML,!u){if(null!=i)for(d={},p=0;p<e.attributes.length;p++)d[e.attributes[p].name]=e.attributes[p].value;(f||l)&&(f&&l&&f.__html==l.__html||(e.innerHTML=f&&f.__html||""))}(function(e,t,n,r,o){var i;for(i in n)"children"===i||"key"===i||i in t||it(e,i,null,n[i],r);for(i in t)o&&"function"!=typeof t[i]||"children"===i||"key"===i||"value"===i||"checked"===i||n[i]===t[i]||it(e,i,t[i],n[i],r)})(e,h,d,o,u),f?t.__k=[]:(s=t.props.children,rt(e,Array.isArray(s)?s:[s],t,n,r,"foreignObject"!==t.type&&o,i,a,He,u)),u||("value"in h&&void 0!==(s=h.value)&&s!==e.value&&it(e,"value",s,d.value,!1),"checked"in h&&void 0!==(s=h.checked)&&s!==e.checked&&it(e,"checked",s,d.checked,!1))}return e}function lt(e,t,n){try{"function"==typeof e?e(t):e.current=t}catch(e){Ce.__e(e,n)}}function ft(e,t,n){var r,o,i;if(Ce.unmount&&Ce.unmount(e),(r=e.ref)&&(r.current&&r.current!==e.__e||lt(r,null,t)),n||"function"==typeof e.type||(n=null!=(o=e.__e)),e.__e=e.__d=void 0,null!=(r=e.__c)){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(e){Ce.__e(e,t)}r.base=r.__P=null}if(r=e.__k)for(i=0;i<r.length;i++)r[i]&&ft(r[i],t,n);null!=o&&Je(o)}function pt(e,t,n){return this.constructor(e,n)}function dt(e,t,n){var r,o,i;Ce.__&&Ce.__(e,t),o=(r=n===Fe)?null:n&&n.__k||t.__k,e=Ke(Xe,null,[e]),i=[],ut(t,(r?t:n||t).__k=e,o||He,He,void 0!==t.ownerSVGElement,n&&!r?[n]:o?null:t.childNodes.length?ze.slice.call(t.childNodes):null,i,n||He,r),st(i,e)}Ce={__e:function(e,t){for(var n,r;t=t.__;)if((n=t.__c)&&!n.__)try{if(n.constructor&&null!=n.constructor.getDerivedStateFromError&&(r=!0,n.setState(n.constructor.getDerivedStateFromError(e))),null!=n.componentDidCatch&&(r=!0,n.componentDidCatch(e)),r)return tt(n.__E=n)}catch(t){e=t}throw e}},Ye.prototype.setState=function(e,t){var n;n=this.__s!==this.state?this.__s:this.__s=Ve({},this.state),"function"==typeof e&&(e=e(n,this.props)),e&&Ve(n,e),null!=e&&this.__v&&(t&&this.__h.push(t),tt(this))},Ye.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),tt(this))},Ye.prototype.render=Xe,We=[],Te=0,Ie="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Fe=He;var ht=function(e,t,n,r){var o;t[0]=0;for(var i=1;i<t.length;i++){var a=t[i++],u=t[i]?(t[0]|=a?1:2,n[t[i++]]):t[++i];3===a?r[0]=u:4===a?r[1]=Object.assign(r[1]||{},u):5===a?(r[1]=r[1]||{})[t[++i]]=u:6===a?r[1][t[++i]]+=u+"":a?(o=e.apply(u,ht(e,u,n,["",null])),r.push(o),u[0]?t[0]|=2:(t[i-2]=0,t[i]=o)):r.push(u)}return r},vt=new Map;var _t=function(e){var t=vt.get(this);return t||(t=new Map,vt.set(this,t)),(t=ht(this,t.get(e)||(t.set(e,t=function(e){for(var t,n,r=1,o="",i="",a=[0],u=function(e){1===r&&(e||(o=o.replace(/^\s*\n\s*|\s*\n\s*$/g,"")))?a.push(0,e,o):3===r&&(e||o)?(a.push(3,e,o),r=2):2===r&&"..."===o&&e?a.push(4,e,0):2===r&&o&&!e?a.push(5,0,!0,o):r>=5&&((o||!e&&5===r)&&(a.push(r,0,o,n),r=6),e&&(a.push(r,e,0,n),r=6)),o=""},s=0;s<e.length;s++){s&&(1===r&&u(),u(s));for(var c=0;c<e[s].length;c++)t=e[s][c],1===r?"<"===t?(u(),a=[a],r=3):o+=t:4===r?"--"===o&&">"===t?(r=1,o=""):o=t+o[0]:i?t===i?i="":o+=t:'"'===t||"'"===t?i=t:">"===t?(u(),r=1):r&&("="===t?(r=5,n=o,o=""):"/"===t&&(r<5||">"===e[s][c+1])?(u(),3===r&&(a=a[0]),r=a,(a=a[0]).push(2,0,r),r=0):" "===t||"\t"===t||"\n"===t||"\r"===t?(u(),r=2):o+=t),3===r&&"!--"===o&&(r=4,a=a[0])}return u(),a}(e)),t),arguments,[])).length>1?t:t[0]}.bind(Ke),gt={USA:"USA",USSR:"USSR",none:"Neutral"},mt={scoring:"Scoring",continuous:"Ongoing Effect",unique:"Removed After Event",war:"War"};var yt={E:"Early War",M:"Mid War",L:"Late War"};function bt({error:e}){return"field"===e.type?function({start:e,end:t,value:n,message:r}){return _t`
    <p class="query-error error-type-field">
      Malformed field '${n}': ${r}
    </p>
  `}({...e}):"syntax"===e.type?function({subtype:e,index:{offset:t,line:n,column:r},expected:o}){return _t`
    <p class="query-error error-type-field">
      Syntax error: ${e}
    </p>
  `}({...e}):(console.error("unknown type of query error",e),!1)}function wt({description:e,count:t}){return _t`
    <p class="query-description">
      <strong class="card-count">${t} cards</strong> where ${e}.
    </p>
  `}function Et({card:e}){return _t`
    ${null!==e.ops&&_t`<span class="card-ops">${e.ops} OPS</span>`}
    ${" "}
    <span class="card-side">${gt[e.side]}</span>
    ${" "}
    Event
    ${e.types.length>0&&_t` – <span class="card-types">
      ${t=e.types,t.map(e=>mt[e]).join(", ")}
    </span>`}
  `;var t}function xt({card:e}){return _t`
  <a href=${e.permalink} class="card small ${e.version}${e.match?" match":""}">
    <h2 class="card-titleline">
      <span class="card-number">${String(e.number).padStart(3,"0")}</span>
      -
      <span class="card-period">${e.period}</span>
      ${" "}
      <span class="card-title">${e.name}</span>
      ${" "}
      <span class="card-version">(${t=e.version,t.substring(0,1).toUpperCase()+t.substring(1).toLowerCase()})</span>
    </h2>
    <p class="card-typeline">
      <${Et} card=${e} />
    </p>
    <!-- TODO: find a way to render html from a string without
    dangerouslySetInnerHTML. htm unfortunately does not unescape html entities
    -->
     <!-- TODO: can we at least check subresource integrity on the fetched card
     index? -->
    <div class="card-text" dangerouslySetInnerHTML=${{__html:e.htmlContent}}>
    </div>
  </a>
  `;var t}function kt({results:e}){return _t`<ul class="card-list">
    ${e.map(e=>_t`<${St} cards=${e} />`)}
  </ul>`}function St({cards:e}){const t=e.filter(e=>"oracle"===e.version)[0],n=e.filter(e=>"printed"===e.version)[0];return _t`<li>
    <div class="flex-gutter-wrapper">
      <${xt} card=${t} />
      <${xt} card=${n} />
    </div>
  </li>`}const Ot={number:new De("the card number",!1,"number"),name:new Ue("the name",!1,"name",{caseSensitive:!1}),version:new Ue("the version",!1,"version",{caseSensitive:!1}),ops:new De("the operations value",!1,"ops"),types:new class extends class{constructor(e,t,n){var{caseSensitive:r=!0}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this.name=e,this.plural=t,this.property=n,this.caseSensitive=r}":"(e){var t=this.caseSensitive?e:e.toUpperCase();return{status:!0,describe:t=>Ee({name:this.name,plural:this.plural,negated:t,value:'"'.concat(e,'"')}),predicate:e=>e[this.property].some(e=>{var n,r,o=this.caseSensitive?e:null==e||null===(n=e.toUpperCase)||void 0===n?void 0:n.call(e);return null==o||null===(r=o.includes)||void 0===r?void 0:r.call(o,t)})}}}{constructor(){super("the types",!0,"types",{caseSensitive:!1})}":"(e){const t=super[":"](e);return{status:!0,describe:t.describe,predicate:e=>t.predicate({types:e.types.map(e=>mt[e])})}}},text:new Ue("the text",!1,"plainContent",{caseSensitive:!1}),side:new class extends Ue{constructor(){super("the side",!1,"side",{caseSensitive:!1})}":"(e){const t=super[":"](e);return{status:!0,describe:t.describe,predicate:e=>t.predicate({side:gt[e.side]})}}"="(e){const t=super["="](e);return{status:!0,describe:t.describe,predicate:e=>t.predicate({side:gt[e.side]})}}},period:new class extends Ue{constructor(){super("the period",!1,"period",{caseSensitive:!1})}":"(e){const t=super[":"](e);return{status:!0,describe:t.describe,predicate:e=>t.predicate({period:yt[e.period]})}}"="(e){const t=super["="](e),n={...t};return e.length>1&&(n.predicate=e=>t.predicate({period:yt[e.period]})),n}}};Ot[""]=new class{constructor(e,t,n,{operators:r=[":",">",">=","=","<=","<"],descriptors:o={},defaultOperator:i=":"}={}){this.name=e,this.plural=t,this.fields=n,o=Object.assign({":":Ee,">":Se,">=":Oe,"=":xe,"<=":je,"<":Ne},o);for(let e of r)this[e]=function(t){const n=[];for(let r of this.fields)if(e in r){const o=r[e](t);o.status&&n.push(o)}return{status:!0,describe:n=>o[e](this.makeMessageArg({value:t,negated:n})),predicate:e=>n.some(({predicate:t})=>t(e))}};!1!==i&&(this[""]=this[i])}makeMessageArg({value:e,negated:t}){return{name:this.name,plural:this.plural,negated:t,value:`"${e}"`}}}("any field",!1,Object.values(Ot));const jt=new class{constructor(){var{operators:e=[":",">=","<=","<","=",">"],termHandler:t=new qe,descriptors:{conjunction:n=(e=>{var{left:t,right:n}=e;return ye({left:t,right:n})}),disjunction:r=(e=>{var{left:t,right:n}=e;return be({left:t,right:n})}),parenthetical:o=(e=>{var{expression:t,negated:n}=e;return we({expression:t,negated:n})})}={}}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.parser=new ve({operators:e}),this.termHandler=t,this.descriptors={conjunction:n,disjunction:r,parenthetical:o}}query(e){var t=this.parse(e);return t.status&&(t.description=this.describeNode(t.ast),t.predicate=this.evaluateNode(t.ast)),t}parse(e){var t,{status:n,value:r,index:o,expected:i}=this.parser.parse(e);if(n)n=0===(t=this.validateNode(r)).length;else{var a="unknown",u=o.offset;")"===e[u]&&this.parser.parse(e.substring(0,u)).status?a="unopened parenthetical":u===e.length&&i.includes("closing )")?a="unclosed parenthetical":u===e.length&&i.includes('closing "')&&(a="unclosed quotation"),t=[{type:"syntax",index:o,expected:i,subtype:a}]}return{status:n,errors:t,ast:r}}describe(e){return this.describeNode(this.parser.parse(e).value)}describeNode(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];switch(e.name){case"And":return this.descriptors.conjunction({left:this.describeNode(e.value[0]),right:this.describeNode(e.value[1])});case"Or":return this.descriptors.disjunction({left:this.describeNode(e.value[0]),right:this.describeNode(e.value[1])});case"Not":return this.describeNode(e.value,!t);case"Nil":return"";case"Parenthetical":return this.descriptors.parenthetical({expression:this.describeNode(e.value),negated:t});case"Term":return this.termHandler.get(...e.value).describe(t);default:throw new Ae(e)}}validateNode(e){switch(e.name){case"And":case"Or":return[...this.validateNode(e.value[0]),...this.validateNode(e.value[1])];case"Not":case"Parenthetical":return this.validateNode(e.value);case"Nil":return[];case"Term":var{status:t,error:n}=this.termHandler.get(...e.value);if(t)return[];var{start:r,end:o,value:i}=e;return[{type:"field",start:r,end:o,value:i,message:n}];default:throw new Ae(e)}}evaluate(e){var{status:t,value:n}=this.parser.parse(e);if(!t)throw new Error('parse failed for "'.concat(e,'"'));return this.evaluateNode(n)}evaluateNode(e){switch(e.name){case"And":var t=this.evaluateNode(e.value[0]),n=this.evaluateNode(e.value[1]);return e=>t(e)&&n(e);case"Or":var r=this.evaluateNode(e.value[0]),o=this.evaluateNode(e.value[1]);return e=>r(e)||o(e);case"Not":var i=this.evaluateNode(e.value);return e=>!i(e);case"Term":return this.termHandler.get(...e.value).predicate;case"Nil":return()=>!1;case"Parenthetical":var a=this.evaluateNode(e.value);return e=>a(e);default:throw new Ae(e)}}}({termHandler:new class{constructor(e){var{errors:{missingField:t=Pe,missingOperator:n=Be}={}}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.fields=e,this.errorDesciptors={missingField:t,missingOperator:n}}get(e,t,n){return this.fields[e]?this.fields[e][t]?this.fields[e][t](n):{status:!1,error:this.errorDesciptors.missingOperator({name:e,operator:t})}:{status:!1,error:this.errorDesciptors.missingField({name:e})}}}(Ot)});function Nt(){document.getElementById("search-syntax").style.display="block"}const Pt=document.getElementById("search-results"),Bt=document.getElementById("search-text-input"),$t=new URLSearchParams(location.search).get("q");if(null===$t)Nt();else{Bt.value=$t;const e=fetch("/cards/index.json").then(e=>e.json()),{status:t,description:n,predicate:r,errors:o}=jt.query($t);t?(async()=>{const t=function(e,t){const n=new Map;for(let r of t){const t=e(r);n.has(t)?n.get(t).push(r):n.set(t,[r])}return[...n.values()]}(e=>e.number,(await e).map(e=>(e.match=r(e),e))).filter(e=>e.some(e=>e.match)).sort((e,t)=>e[0].number-t[0].number),o=t.length;dt(_t`
          <${wt} description=${n} count=${o} />
          <${kt} results=${t} />
        `,Pt)})():(dt(_t`${o.map(e=>bt({error:e}))}`,Pt),Nt())}}();
//# sourceMappingURL=search.js.map
